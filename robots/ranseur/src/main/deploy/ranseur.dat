#
# This file describes the ranseur robot.
#

###################################################################################################
#
# Hardware definitions, this is the equivalent of the old signal power table, 
# at least the signal part of it.
#
###################################################################################################

#
# Hardware
#
hw:bunnyarm:solenoid                                            6
hw:tubtoucher:solenoid:1_1                                      0
hw:tubtoucher:solenoid:1_2                                      1
hw:tubtoucher:solenoid:2_1                                      4
hw:tubtoucher:solenoid:2_2                                      5

hw:tubcollector1:type                                           "victor_spx"
hw:tubcollector1:canid                                          6
hw:tubcollector2:type                                           "victor_spx"
hw:tubcollector2:canid                                          9
hw:tubcollector:clamp                                           7
hw:tubcollector:tubsensor                                       9                           # Digital IO

hw:tubarm:motor:canid                                           8
hw:tubarm:motor:type                                            "victor_spx"
hw:tubarm:motor:invert                                          true
hw:tubarm:encoder:analog                                        1
hw:tubarm:encoder:analog:m                                      -72
hw:tubarm:encoder:analog:b                                      295.92

hw:tubwrist:motor:canid                                         7
hw:tubwrist:motor:type                                          "victor_spx"
hw:tubwrist:encoder:analog                                      0
hw:tubwrist:encoder:analog:m                                    72
hw:tubwrist:encoder:analog:b                                    -126

hw:tankdrive:motors:left:1:canid                                1
hw:tankdrive:motors:left:2:canid                                2
hw:tankdrive:motors:left:3:canid                                3
hw:tankdrive:motors:right:1:invert                               true
hw:tankdrive:motors:right:2:invert                               true
hw:tankdrive:motors:right:3:invert                               true
hw:tankdrive:motors:right:1:canid                               4
hw:tankdrive:motors:right:2:canid                               5
hw:tankdrive:motors:right:3:canid                               6
hw:tankdrive:motors:left:1:type                                 "sparkmax_brushless"
hw:tankdrive:motors:left:2:type                                 "sparkmax_brushless"
hw:tankdrive:motors:left:3:type                                 "sparkmax_brushless"
hw:tankdrive:motors:right:1:type                                "sparkmax_brushless"
hw:tankdrive:motors:right:2:type                                "sparkmax_brushless"
hw:tankdrive:motors:right:3:type                                "sparkmax_brushless"
hw:tankdrive:leftencoder:1                                      4                            # Digital IO
hw:tankdrive:leftencoder:2                                      5                            # Digital IO
hw:tankdrive:rightencoder:1                                     6                            # Digital IO
hw:tankdrive:rightencoder:2                                     7                            # Digital IO

#
# Driver station
#
hw:driverstation:hid:driver                                     0                            # HID Device Index
hw:driverstation:hid:oi                                         2                            # HID Device Index

###################################################################
#
# The sections below describe the software parameters for the various
# robot subsystems
#
###################################################################

###################################################################################################
# misc
###################################################################################################

#
# Enable plotting.  Plot data is stored in the network tables and display
# programs read the data from the network tables
#
plotting:enabled                                               true


###################################################################################################
# tankdrive
###################################################################################################

#
# Variables for the tankdrive subsystem code.
#
tankdrive:inches_per_tick                                       0.031024151
tankdrive:width                                                 30.0
tankdrive:scrub                                                 1.0

tankdrive:follower:left:kv1                                     192.0
tankdrive:follower:left:kv2                                     0.0
tankdrive:follower:left:ka                                      0.0001
tankdrive:follower:left:kp                                      0.0                 # Recommended 0.02032 - 0.03048
tankdrive:follower:left:kd                                      0.0

tankdrive:follower:right:kv1                                    192.0
tankdrive:follower:right:kv2                                    0.0
tankdrive:follower:right:ka                                     0.0001
tankdrive:follower:right:kp                                     0.0                 # Recommended 0.02032 - 0.03048
tankdrive:follower:right:kd                                     0.0

tankdrive:follower:turn_correction                              0
tankdrive:follower:angle_correction                             0.06

tankdrive:distance_action:maxa                                  36.0
tankdrive:distance_action:maxd                                  -36.0
tankdrive:distance_action:maxv                                  36.0

tankdrive:distance_action:angle_pid:p                           0.0
tankdrive:distance_action:angle_pid:i                           0.0
tankdrive:distance_action:angle_pid:d                           0.0
tankdrive:distance_action:angle_pid:f                           0.0
tankdrive:distance_action:angle_pid:min                         -1.0
tankdrive:distance_action:angle_pid:max                         1.0
tankdrive:distance_action:angle_pid:imax                        0.0

tankdrive:distance_action:distance_threshold                    999.0
tankdrive:distance_action:profile_outdated_error_long           8.0
tankdrive:distance_action:profile_outdated_error_short          4.0
tankdrive:distance_action:profile_outdated_error_dist           12.0

###################################################################################################
# bunnyarm
###################################################################################################
bunnyarm:deploy:time                                             0.5

###################################################################################################
# tubtoucher
###################################################################################################
tubtoucher:deploy:time                                           0.5

###################################################################################################
# tubcollector
###################################################################################################
tubcollector:eject:power                                        0.5
tubcollector:eject:duration                                     2.0      
tubcollector:collect:power                                      -0.5
tubcollector:collect:duration                                   0.5                                        
tubcollector:tubsensor:h2ldelay                                 0
tubcollector:tubsensor:l2hdelay                                 0
tubcollector:eject:speed                                        1
tubcollector:eject:delay                                        1

###################################################################################################
# tubwrist
###################################################################################################
tubwrist:hold:p                                                 0.01
tubwrist:hold:i                                                 0
tubwrist:hold:d                                                 0
tubwrist:hold:f                                                 0
tubwrist:hold:a                                                 0
tubwrist:hold:min                                               -0.6
tubwrist:hold:max                                               0.6
tubwrist:hold:imax                                              0.0 
tubwrist:goto:threshold                                         3.0       # Within three degrees
tubwrist:goto:maxd                                              -160.0    # maximum deceleration
tubwrist:goto:maxa                                              160.0     # maximum acceleration
tubwrist:goto:maxv                                              160.0     # maximum velocity
tubwrist:follower:down:kp                                       0.0
tubwrist:follower:down:kd                                       0.0
tubwrist:follower:down:kv                                       0.005555556
tubwrist:follower:down:ka                                       0.0
tubwrist:follower:up:kp                                         0.0
tubwrist:follower:up:kd                                         0.0
tubwrist:follower:up:kv                                         0.005555556
tubwrist:follower:up:ka                                         0.0
tubwrist:collect:pos                                            1
tubwrist:dump:pos                                               135
tubwrist:eject:pos                                              0
tubwrist:power                                                  0.2
tubwrist:duration                                                4
tubwrist:turtle:pos                                             90

###################################################################################################
# tubarm
###################################################################################################
tubarm:hold:p                                                   0.01
tubarm:hold:i                                                   0
tubarm:hold:d                                                   0
tubarm:hold:f                                                   0
tubarm:hold:a                                                   0
tubarm:hold:min                                                 -0.6
tubarm:hold:max                                                 0.6
tubarm:hold:imax                                                0.0
tubarm:goto:threshold                                           3.0      # Within three degrees
tubarm:goto:maxd                                                -180.0    # maximum deceleration (way too slow, used for demo)
tubarm:goto:maxa                                                180.0     # maximum acceleration (way too slow, used for demo)
tubarm:goto:maxv                                                90.0     # maximum velocity (way too slow, used for demo)
tubarm:follower:down:kp                                         0.0
tubarm:follower:down:kd                                         0.0
tubarm:follower:down:kv                                         0.011111111
tubarm:follower:down:ka                                         0.0
tubarm:follower:up:kp                                           0.0
tubarm:follower:up:kd                                           0.0
tubarm:follower:up:kv                                           0.011111111
tubarm:follower:up:ka                                           0.0
tubarm:collect:pos                                              0
tubarm:dump:pos                                                 90
tubarm:eject:pos                                                0
tubarm:power                                                    0.2
tubarm:duration                                                 4
tubarm:turtle:pos                                               90

###################################################################################################
# ranseurvision
###################################################################################################

ranseurvision:distance_threshold                                60.0
ranseurvision:camera_height                                     8.0
ranseurvision:camera_angle                                      0.0
ranseurvision:target_height                                     4.0

###################################################################################################
# drive by vision (simple P only control)
###################################################################################################

drivebyvision:yaw_base_power                                    0.4
drivebyvision:yaw_p                                             0.002
drivebyvision:distance_threshold                                2.0

###################################################################################################
# Driver gamepad
###################################################################################################

driver:power:max                                                1.0
driver:power:default                                            0.6
driver:turn:max                                                 0.8
driver:turn:default                                             0.4
driver:power:slowby                                             0.5
driver:power:tolerance                                          0.05
driver:power:nudge_straight                                     0.2
driver:power:nudge_rotate                                       0.2
driver:nudge_time                                               0.1
driver:zerolevel                                                0.1

###################################################################################################
# Variables for the OI
###################################################################################################

oi:collect                                                      12
oi:dump                                                         8
oi:turtle                                                       9
oi:eject                                                        13
oi:tubtoucher                                                   14
oi:spare2                                                       6
oi:automode1                                                    10
oi:automode2                                                    16


###################################################################################################
# Test automodes
###################################################################################################

#
# Which test to run
#
# 0 - apply power to arm (uses power and duration)
# 1 - apply power to wrist (users power and duration)
# 2 - tubarm go to angle (uses angle)
# 3 - tubwrist go to angle (uses angle)
# 4 - bunny arm deploy
# 5 - bunny arm retract
# 6 - tub toucher deploy
# 7 - tub toucher retract
#
automode:test:which                                             7
automode:test:power                                             0.8
automode:test:duration                                          0.3
automode:test:angle                                             90
