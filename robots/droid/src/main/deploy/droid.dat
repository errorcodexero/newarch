#
# This file describes the droid robot.
#

###################################################################################################
#
# Hardware definitions, this is the equivalent of the old signal power table, 
# at least the signal part of it.
#
###################################################################################################

# Drivebase motors
hw:tankdrive:motors:left:1:canid                                1                           # CAN 1
hw:tankdrive:motors:left:1:type                                 "talon_fx"
hw:tankdrive:motors:left:2:canid                                2                           # CAN 2
hw:tankdrive:motors:left:2:type                                 "talon_fx"
hw:tankdrive:motors:right:1:canid                               3                           # CAN 3
hw:tankdrive:motors:right:1:type                                "talon_fx"
hw:tankdrive:motors:right:2:canid                               4                           # CAN 4
hw:tankdrive:motors:right:2:type                                "talon_fx"
hw:tankdrive:invert:motors:right                                true                        # Invert the direction of the right motors

hw:shooter:motor:1:type                                         "sparkmax_brushless"
hw:shooter:motor:1:canid                                        5                          # CAN 5
hw:shooter:motor:2:type                                         "sparkmax_brushless"
hw:shooter:motor:2:canid                                        6                          # CAN 6
hw:shooter:motor:2:invert                                       true
hw:shooter:encoder:quad:motor                                   true                        # Use encoder in NEO motor
hw:shooter:encoder:quad:m                                       2.1428571429   # 1/42 * 3/2 * 60 (gives output in RPM)
hw:shooter:encoder:quad:b                                       0

hw:conveyor:motors:intake:type                                  "sparkmax_brushless"
hw:conveyor:motors:intake:canid                                 7                          # CAN 7
hw:conveyor:motors:intake:neutral_mode                          "brake"
hw:conveyor:motors:shooter:type                                 "sparkmax_brushless"
hw:conveyor:motors:shooter:canid                                8                          # CAN 8
hw:conveyor:motors:shooter:neutral_mode                         "brake"
hw:conveyor:sensor:a                                            13
hw:conveyor:sensor:b                                            12
hw:conveyor:sensor:c                                            11
hw:conveyor:sensor:d                                            10

hw:turret:motor:type                                            "sparkmax_brushless"
hw:turret:motor:canid                                           9                          # CAN 9
hw:turret:motor:invert                                          true
hw:turret:encoder:analog                                        3                          # Analog encoder
hw:turret:encoder:analog:rmin                                   -180.0
hw:turret:encoder:analog:rmax                                   180.0
hw:turret:encoder:analog:emin                                   5.0
hw:turret:encoder:analog:emax                                   0.0
hw:turret:encoder:analog:ec                                     1.06
hw:turret:encoder:analog:rc                                     0.0

hw:intake:collect:motor:type                                   "sparkmax_brushless"
hw:intake:collect:motor:canid                                  10                          # CAN 10
hw:intake:motor:type                                           "sparkmax_brushless"
hw:intake:motor:canid                                          11                          # CAN 11
hw:intake:encoder:quad:motor                                   true
hw:intake:encoder:quad:m                                       1.0
hw:intake:encoder:quad:b                                       0.0

hw:controlpanelrotator:motor:type                               "sparkmax_brushless"
hw:controlpanelrotator:motor:canid                              12                           # CAN 12
hw:controlpanelrotator:encoder:quad:motor                       true
hw:controlpanelrotator:encoder:quad:m                           1
hw:controlpanelrotator:encoder:quad:b                           0

hw:climber:motor:1:type                                         "sparkmax_brushless"
hw:climber:motor:1:canid                                        13                          # CAN 13
hw:climber:motor:2:type                                         "sparkmax_brushless"
hw:climber:motor:2:canid                                        14                          # CAN 14
hw:climber:motor:2:invert                                       true
hw:climber:motor:release                                        -10
hw:climber:motor:climb                                          10
hw:climber:encoder:quad:motor                                   true
hw:climber:encoder:quad:m                                       1
hw:climber:encoder:quad:b                                       0
hw:climber:servo:l:pwmid                                        0                           # PWM 2
hw:climber:servo:r:pwmid                                        1                           # PWM 1
hw:climber:servo:l:release                                      1.0
hw:climber:servo:r:release                                      1.0
hw:climber:servo:l:climb                                        0.0
hw:climber:servo:r:climb                                        0.0

intake:collector:motor:power                                    0.3
intake:arm:collecton:pos                                        1350
intake:arm:collectoff:pos                                       0
intake:hold:p                                                   0.002
intake:hold:i                                                   0
intake:hold:d                                                   0
intake:hold:f                                                   0
intake:hold:min                                                 0
intake:hold:max                                                 0
intake:hold:imax                                                0
intake:follower:down:kp                                       0.0
intake:follower:down:kd                                       0.0
intake:follower:down:kv                                       0.000125628
intake:follower:down:ka                                       0.0
intake:follower:up:kp                                         0.0
intake:follower:up:kd                                         0.0
intake:follower:up:kv                                         0.000138026
intake:follower:up:ka                                         0.0
intake:goto:threshold                                       10.0       # Within three degrees
intake:goto:maxd                                            -21000.0     # maximum deceleration
intake:goto:maxa                                            21000.0     # maximum acceleration
intake:goto:maxv                                            14000.0     # maximum velocity

#
# Driver station
#
hw:driverstation:hid:driver                                     0               # HID Device Index
hw:driverstation:hid:oi                                         2               # HID Device Index



###################################################################################################
#
# The sections below describe the software parameters for the various
# robot subsystems
#
###################################################################################################

###################################################################################################
# tankdrive
###################################################################################################

#
# Variables for the tankdrive subsystem code.
#
tankdrive:inches_per_tick                                       0.00085
tankdrive:width                                                 221425
tankdrive:scrub                                                 0.95177665

tankdrive:follower:left:ka                                      0.0025
tankdrive:follower:left:kv                                      0.006112469         # 0.005
tankdrive:follower:left:kp                                      0.03248             # Recommended 0.02032 - 0.03048
tankdrive:follower:left:kd                                      0.0

tankdrive:follower:right:ka                                     0.0025
tankdrive:follower:right:kv                                     0.006112469         # 0.005
tankdrive:follower:right:kp                                     0.03248             # Recommended 0.02032 - 0.03048
tankdrive:follower:right:kd                                     0.0

tankdrive:follower:turn_correction                              0
tankdrive:follower:angle_correction                             0.06

###################################################################################################
# shooter
###################################################################################################

shooter:velocity:p                                              0
shooter:velocity:i                                              0.0
shooter:velocity:d                                              0.0
shooter:velocity:f                                              0.0001145
shooter:velocity:min                                            -1.0
shooter:velocity:max                                            1.0
shooter:velocity:imax                                           0.0

shooter:velocity:ready_margin_percent                           5.0      # If velocity is within % margin from target, consider it ready to shoot

shooter:hold:p                                                  0.0
shooter:hold:i                                                  0.0
shooter:hold:d                                                  0.0
shooter:hold:f                                                  0.0
shooter:hold:min                                                -1.0
shooter:hold:max                                                1.0
shooter:hold:imax                                               0.0

###################################################################################################
# turret
###################################################################################################

turret:goto:threshold                                           3.0
turret:goto:maxa                                                70
turret:goto:maxd                                                -70
turret:goto:maxv                                                70

turret:follow:p                                                 -0.014084508
turret:follow:i                                                 0
turret:follow:d                                                 0.0
turret:follow:f                                                 0
turret:follow:min                                               -1
turret:follow:max                                               1
turret:follow:imax                                              0

turret:follower:up:kp                                                 0
turret:follower:up:ki                                                 0
turret:follower:up:kd                                                 0
turret:follower:up:kv                                                 0.003521127
turret:follower:up:ka                                                 0
turret:follower:up:min                                               -1
turret:follower:up:max                                               1
turret:follower:up:imax                                              0
turret:follower:down:kp                                                 0
turret:follower:down:ki                                                 0
turret:follower:down:kd                                                 0
turret:follower:down:kv                                                 0.003521127
turret:follower:down:ka                                                 0
turret:follower:down:min                                               -1
turret:follower:down:max                                               1
turret:follower:down:imax                                              0
turret:fire_threshold                                           0.5
turret:min                                                      -90 # The minimum safe angle.
turret:max                                                      90  # The maximum safe angle.



###################################################################################################
# controlpanelrotator
###################################################################################################

controlpanelrotator:hold:p                                      0
controlpanelrotator:hold:i                                      0
controlpanelrotator:hold:d                                      0
controlpanelrotator:hold:f                                      0
controlpanelrotator:hold:min                                    0
controlpanelrotator:hold:max                                    1
controlpanelrotator:hold:imax                                   1

###################################################################################################
# conveyor
###################################################################################################

conveyor:motorstates:stopped:intake                             0
conveyor:motorstates:stopped:shooter                            0

conveyor:motorstates:move_towards_shooter:intake                1
conveyor:motorstates:move_towards_shooter:shooter               1

conveyor:motorstates:move_towards_intake:intake                 -1
conveyor:motorstates:move_towards_intake:shooter                -1

###################################################################################################
# Variables for the driver gamepad
###################################################################################################

driver:power:max                                                1.0
driver:power:default                                            0.6
driver:turn:max                                                 0.8
driver:turn:default                                             0.4
driver:power:slowby                                             0.5
driver:power:tolerance                                          0.05
driver:power:nudge_straight                                     0.2
driver:power:nudge_rotate                                       0.2
driver:nudge_time                                               0.1
driver:zerolevel                                                0.1

###################################################################################################
# Climber
###################################################################################################

climber:servo:l:angle_hold                                     -1
climber:servo:l:angle_release                                  -1
climber:servo:r:angle_hold                                     -1
climber:servo:r:angle_release                                  -1
climber:servo:r:climb                                          0
climber:servo:l:climb                                          0
climber:servo:r:release                                        0
climber:servo:l:release                                        0

climber:motor:follower:up:maxkp                                0
climber:motor:follower:up:maxki                                0
climber:motor:follower:up:maxkd                                0
climber:motor:follower:up:maxkv                                0.003521127
climber:motor:follower:up:maxka                                0
climber:motor:follower:up:min                                  -1
climber:motor:follower:up:max                                  1
cilmber:motor:follower:up:imax                                 0

climber:motor:follower:down:maxkp                              0
climber:motor:follower:down:maxki                              0
climber:motor:follower:down:maxkd                              0
climber:motor:follower:down:maxkv                              0.003521127
climber:motor:follower:down:maxka                              0
climber:motor:follower:down:min                                -1
climber:motor:follower:down:max                                1
cilmber:motor:follower:down:imax                               0

climber:motor:goto:threshold                                   3.0
climber:motor:goto:maxa                                        70
climber:motor:goto:maxd                                        -70
climber:motor:goto:maxv                                        70


###################################################################################################
# droidvision
###################################################################################################

droidvision:camera_angle                                        21.73
droidvision:camera_target_height                                68.0
limelight:camera_latency                                        11.0
limelight:network_latency                                       10.0

gamepiecemanipulator:fire:max_drivebase_velocity                0.0
gamepiecemanipulator:fire:max_camera_sample_age                 5.0

###################################################################################################
# oi
###################################################################################################

oi:shoot_collect_mode                                           1
oi:shoot_onoff                                                  2
oi:collect_onoff                                                3

oi:collvshoot                                                   4
oi:collect                                                      5 
oi:shoot                                                        6

###################################################################################################
# targettracker
###################################################################################################
# The location of the target on the field.
targettracker:target:x                                          0
targettracker:target:y                                          30  # placeholder

# In order to attempt camera tracking, db-estimated angle to target must be less than this value
# This helps prevent us from trying to track the wrong target
targettracker:camera_targetting_max_angle                       45

###################################################################################################
#
# The sections below defines the bahavior of variour misc robot capabilities
#
###################################################################################################

#
# Enable plotting.  Plot data is stored in the network tables and display
# programs read the data from the network tables
#
plotting:enabled                                               true

#
# These control test modes for the robot.  They are used by the DroidTestTuneMode automode.  Note
# this active value below is ignored if we are connected to the field.
#
auto:testmode:active                                          true
auto:testmode:which                                           0
auto:testmode:distance                                        60
auto:testmode:power                                           0.5
auto:testmode:duration                                        3.0

#
# Shoot test parameters
#
shoottest:shoot_delay                                         0.1
shoottest:velocity                                            4000

