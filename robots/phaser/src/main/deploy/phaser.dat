#
# This file describes the phaser robot.  For now
# it describes Grond as we are using grond as a base
# for starting development.  Going forward this will base
# update to reflect phaser (the 2019 robot)
#


#
# The definition of the drivebase (for now this is phoenix)
#
hw:tankdrive:leftmotor:1                                        1               # TALON SRX
hw:tankdrive:leftmotor:2                                        2               # TALON SRX
hw:tankdrive:leftmotor:3                                        3               # TALON SRX
hw:tankdrive:rightmotor:1                                       4               # TALON SRX
hw:tankdrive:rightmotor:2                                       5               # TALON SRX
hw:tankdrive:rightmotor:3                                       6               # TALON SRX
hw:tankdrive:leftencoder:1                                      0               # Digital IO
hw:tankdrive:leftencoder:2                                      1               # Digital IO
hw:tankdrive:rightencoder:1                                     2               # Digital IO
hw:tankdrive:rightencoder:2                                     3               # Digital IO
hw:tankdrive:shifter                                            0               # Solenoid
hw:tankdrive:invert:motors:left                                true
hw:tankdrive:invert:encoders:left                              true

hw:hatchholder:arm:extend                                        6              # Solenoid
hw:hatchholder:arm:retract                                       7              # Solenoid
hw:hatchholder:finger                                            5              # Solenoid
hw:hatchholder:sensor                                           21              # Digital IO

hw:hatchintake:motor                                            12              # Victor SPX
hw:hatchintake:sensor                                           23              # Digital IO
hw:hatchintake:solenoid                                         2               # Solenoid

hw:lifter:encoder1                                              8               # Digital IO
hw:lifter:encoder2                                              9               # Digital IO
hw:lifter:motor:1                                               10               # TalonSRX
hw:lifter:motor:2                                               11               # TalonSRX
hw:lifter:reversemotors                                         true            

hw:turntable:encoder1                                           4               # Digital IO
hw:turntable:encoder2                                           5               # Ditigal IO
hw:turntable:motor:1                                            8               # TALON SRX

hw:linesensor:front:0                                           10              # Digital IO
hw:linesensor:front:1                                           11              # Digital IO
hw:linesensor:front:2                                           12              # Digital IO

hw:linesensor:back:0                                            13              # Digital IO
hw:linesensor:back:1                                            18              # Digital IO
hw:linesensor:back:2                                            19              # Digital IO

hw:driverstation:hid:driver                                     0               # HID Device Index
hw:driverstation:hid:oi                                         2               # HID Device Index

hw:cargoholder:sensor                                           20              # Digital IO
hw:cargoholder:motor                                            7              # Victor SPX

hw:cargointake:motor                                            9              # Victor SPX
hw:cargointake:solenoid                                         1              # Solenoid
hw:cargointake:sensor                                           22             # Sensor
hw:climber:solenoid                                             3               # Solenoid



###################################################################
#
# The sections below describe the software parameters for the various
# robot subsystems
#
###################################################################

#
# Variables for the tankdrive subsystem code.  These are currently
# aligned with Phoenix as the basis for the Phaser code until we get
# a Phaser drivebase
#
tankdrive:inches_per_tick                                       0.010952734
tankdrive:width                                                 22
tankdrive:scrub                                                 0.9

tankdrive:follower:left:ka                                      0.0
tankdrive:follower:left:kv                                      0.00625   #0.00624
tankdrive:follower:left:kp                                      0.005
tankdrive:follower:left:kd                                      0.0

tankdrive:follower:right:ka                                     0.0
tankdrive:follower:right:kv                                     0.00637    #0.00636
tankdrive:follower:right:kp                                     0.005
tankdrive:follower:right:kd                                     0.0

tankdrive:follower:turn_correction                              0.0
tankdrive:follower:angle_decay                                  0.0

#
# Variables for the driver gamepad
#
driver:power:max                                                1.0
driver:power:default                                            0.6
driver:power:slowby                                             0.5
driver:power:tolerance                                          0.05
driver:power:nudge_straight                                     0.2
driver:power:nudge_rotate                                       0.2
driver:nudge_time                                               0.1

#
# Setup the data plotter
#
plotter:port                                                    5555

#
# Variables for the linefollower
#
linefollow:power                                                .4
linefollow:distance                                             16
linefollow:adjust                                               .35

#
# Variables for the turntable
#
turntable:safe_lifter_height                                    17
turntable:keepout:minimum                                       130
turntable:keepout:maximum                                       160
turntable:degrees_per_tick                                      0.5357143
turntable:maxa                                                  150
turntable:maxd                                                  -150
turntable:maxv                                                  200
turntable:base                                                  0.0
turntable:threshold                                             1.0
turntable:follower:kv                                           0.0036
turntable:follower:ka                                           0.0
turntable:follower:kp                                           0.031
turntable:follower:kd                                           0.0
turntable:hold:p                                                0.01
turntable:hold:i                                                0.0
turntable:hold:d                                                0.0
turntable:hold:f                                                0.0
turntable:hold:a                                                0.0
turntable:hold:min                                              -0.5
turntable:hold:max                                              0.5
turntable:hold:imax                                             0.0

turntable:angle:cargo:floor_collect                             -90.0
turntable:angle:hatch:floor_collect                             0.0
turntable:angle:hatch:LS                                        0.0                 #TODO
turntable:angle:score:hatch                                     90.0                #TODO
turntable:angle:score:cargo                                     90.0                #TODO

turntable:angle:cargo:collect:north                             -90                #TODO
turntable:angle:cargo:collect:south                             90                #TODO
turntable:angle:cargo:collect:east                              0                #TODO
turntable:angle:cargo:collect:west                              180                #TODO

turntable:angle:cargo:place:north                               -90                #TODO
turntable:angle:cargo:place:south                               90                #TODO
turntable:angle:cargo:place:east                                0                #TODO
turntable:angle:cargo:place:west                                180                #TODO

turntable:angle:hatch:collect:north                             0                #TODO
turntable:angle:hatch:collect:south                             180                #TODO
turntable:angle:hatch:collect:east                              -90                #TODO
turntable:angle:hatch:collect:west                              90                #TODO
 
turntable:angle:hatch:place:north                               0                #TODO
turntable:angle:hatch:place:south                               180                #TODO
turntable:angle:hatch:place:east                                -90                #TODO
turntable:angle:hatch:place:west                                90                #TODO

#
# Variables for the lifter
#
lifter:base							                            8.46
lifter:inches_per_tick                                          0.05925
lifter:max_height                                               83.66
lifter:min_height                                               8.46
lifter:threshold                                                1.0
lifter:maxv                                                     23.0
lifter:maxa                                                     50.0
lifter:maxd                                                     -50.0
lifter:follower:up:kp                                           0.05              
lifter:follower:up:ka                                           0.0                 
lifter:follower:up:kv                                           0.035
lifter:follower:up:kd                                           0.0

lifter:follower:down:kp                                         0.01
lifter:follower:down:ka                                         0.0
lifter:follower:down:kv                                         0.017
lifter:follower:down:kd                                         0.0

lifter:hold:p                                                   -0.1                
lifter:hold:i                                                   0.0                 
lifter:hold:d                                                   0.0                 
lifter:hold:f                                                   0.0                 
lifter:hold:a                                                   0.0                 
lifter:hold:min                                                 -0.4                
lifter:hold:max                                                 0.4                 
lifter:hold:imax                                                0.0                 

#
# Note, the heights are referenced to the floor.  The height of the lifter is the height of the
# bottom plate of the cargo holder.
#
# The offsets from this are
#
# cargo_holder_center, the height of the cargo holder center above the lifter height
# hatch_center, the height of the center of a hatch on the hatch holder above the lifter height
# hatch_hook_center, the height of the center of the hatch holder above the lifter height
#
lifter:height:bottom                                            8.46
lifter:height:safe_turn                                         18.0
lifter:height:cargo:floor_collect                               9.0
lifter:height:offset:cargo_holder_center                        6.75
lifter:height:offset:hatch_center                               5.5
lifter:height:offset:hatch_hook_center                          8.6                               
lifter:height:hatch:floor_collect                               10                  #TODO
lifter:height:hatch:undock_intake                               22.00
lifter:height:LS:hatch                                          40                  #TODO
lifter:height:LS:hatch:shift_up                                 5                   #TODO
lifter:height:score:hatch                                       40                  #TODO
lifter:height:score:hatch:shift_down                            5                   #TODO
lifter:height:score:cargo                                       5                   #TODO

lifter:height:cargo:collect:north                             18                 #TODO
lifter:height:cargo:collect:south                             18                 #TODO
lifter:height:cargo:collect:east                              18                 #TODO
lifter:height:cargo:collect:west                              18                 #TODO

lifter:height:cargo:place:north:1                             18                 #TODO
lifter:height:cargo:place:south:1                             18                 #TODO
lifter:height:cargo:place:east:1                              18                 #TODO
lifter:height:cargo:place:west:1                              18                 #TODO
lifter:height:cargo:place:north:2                             45                 #TODO
lifter:height:cargo:place:south:2                             45                 #TODO
lifter:height:cargo:place:east:2                              45                 #TODO
lifter:height:cargo:place:west:2                              45                 #TODO
lifter:height:cargo:place:north:3                             70                 #TODO
lifter:height:cargo:place:south:3                             70                 #TODO
lifter:height:cargo:place:east:3                              70                 #TODO
lifter:height:cargo:place:west:3                              70                 #TODO
lifter:height:cargo:place:north:c                             26                 #TODO
lifter:height:cargo:place:south:c                             26                 #TODO
lifter:height:cargo:place:east:c                              26                 #TODO
lifter:height:cargo:place:west:c                              26                 #TODO

lifter:height:hatch:collect:north                             18                 #TODO
lifter:height:hatch:collect:south                             18                 #TODO
lifter:height:hatch:collect:east                              18                 #TODO
lifter:height:hatch:collect:west                              18                 #TODO
 
lifter:height:hatch:place:north:1                             18                 #TODO
lifter:height:hatch:place:south:1                             18                 #TODO
lifter:height:hatch:place:east:1                              18                 #TODO
lifter:height:hatch:place:west:1                              18                 #TODO
lifter:height:hatch:place:north:2                             18                 #TODO
lifter:height:hatch:place:south:2                             18                 #TODO
lifter:height:hatch:place:east:2                              18                 #TODO
lifter:height:hatch:place:west:2                              18                 #TODO
lifter:height:hatch:place:north:3                             18                 #TODO
lifter:height:hatch:place:south:3                             18                 #TODO
lifter:height:hatch:place:east:3                              18                 #TODO
lifter:height:hatch:place:west:3                              18                 #TODO
lifter:height:hatch:place:north:c                             18                 #TODO
lifter:height:hatch:place:south:c                             18                 #TODO
lifter:height:hatch:place:east:c                              18                 #TODO
lifter:height:hatch:place:west:c                              18                 #TODO

lifter:height:offset:hatch_hook_center                          8.6
lifter:height:cargo:undock_height                               22.00
lifter:height:cargo:collected                                   16.0

lifter:height:LS_hatch                                          18              # TODO

cameratracker:distance_threshold                                0.0
cameratracker:yaw_threshold                                     0.0
cameratracker:rect_ratio_min                                    0.0
cameratracker:rect_ratio_max                                    0.0

drivebyvision:yaw_base_power                                    0.2                  
drivebyvision:yaw_p                                             -0.003
drivebyvision:yaw_threshold                                     3.0
drivebyvision:lost_target_threshold                             4
drivebyvision:outer_distance                                    96.0
drivebyvision:inner:0                                           0.90
drivebyvision:inner:1                                           0.98
drivebyvision:inner:2                                           1.02
drivebyvision:inner:3                                           1.1
drivebyvision:outer:0                                           0.90
drivebyvision:outer:1                                           0.98
drivebyvision:outer:2                                           1.02
drivebyvision:outer:3                                           1.10
drivebyvision:scurve_base_power                                 0.2
drivebyvision:scurve_turn_offset                                0.1
drivebyvision:scurve_cycles                                     100
drivebyvision:quit_threshold                                    31.0

cargointake:power                                               -0.6
cargoholder:power                                               0.3
hatchintake:power                                               0.2

score_cargo:power                                               -0.03               #TODO
score_cargo:time                                                2                   #TODO           

oi:hatch_cargo_switch                                           11                  # Button
oi:tracking_viewing_nothing_switch                              3                   # Axis
oi:climb_lock_switch                                            15                  # Button
oi:compass_north                                                13                  # Button
oi:compass_south                                                14                  # Button
oi:compass_east                                                 9                   # Button
oi:compass_west                                                 12                  # Button
oi:height_level_one                                             1                   # Button
oi:height_level_two                                             2                   # Button
oi:height_level_three                                           3                   # Button
oi:height_cargo_bay                                             4                   # Button
oi:collect_floor                                                5                   # Button
oi:go                                                           10                  # Button
oi:score                                                        6                   # Button
oi:climb                                                        8                   # Button
oi:extra_button                                                 7                   # Button
