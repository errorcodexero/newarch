#!/bin/bash

if [ "$#" -lt 2 ]; then
    echo "Invalid number of arguments, expected 2"
    echo "usage: runme start mode"
    echo "  start: L R C"
    echo "  mode: auto teleop test"
    exit 1
fi

pos=17.0,115.0
autovalues=(-1.0 -0.8 -0.6 -0.4 -0.2 0.1 0.3 0.5 0.7 0.9)
extra=""

#
# Set the starting position
#
if [ $1 = "C" ]; then
    pos=17.0,115.0
fi

if [ $1 = "L" ]; then
    pos=17.0,48.0
fi

if [ $1 = "R" ]; then
    pos=17.0,288.0
fi

modeset=false
if [ $2 = "auto" ]; then
    modeset=true
    autotime=60.0
    teleoptime=0.0
    testtime=0.0
    potvalue=${autovalues[$3]}
    extra="--simprop autovalue=$potvalue --simprop gamedata=$4"
fi

if [ $2 = "teleop" ]; then
    modeset=true
    autotime=0.0
    teleoptime=300.0
    testtime=0.0
fi

if [ $2 = "test" ]; then
    modeset=true
    autotime=0.0
    teleoptime=0.0
    testtime=300.0
fi    

gdb --args build/exe/frcUserProgramPhoenixSim/frcUserProgramPhoenixSim.exe --simfile SIM --robotfile ROBOT --test $testtime --start 0 --auto $autotime --oper $teleoptime --simscreen --simprop pos=$pos $extra
